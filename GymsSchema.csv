CREATE TABLE public."Exercises" (
	"Id" int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	"Name" text NOT NULL,
	"Description" text NULL,
	CONSTRAINT "PK_Exercises" PRIMARY KEY ("Id")
);


CREATE TABLE public."Gyms" (
	"Id" int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	"Name" text NOT NULL,
	CONSTRAINT "PK_Gyms" PRIMARY KEY ("Id")
);


CREATE TABLE public."LoginDetails" (
	"Id" int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	"Username" text NOT NULL,
	"Password" text NOT NULL,
	CONSTRAINT "PK_LoginDetails" PRIMARY KEY ("Id")
);


CREATE TABLE public."GymEquipments" (
	"Id" int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	"Name" text NOT NULL,
	"GymId" int4 NOT NULL,
	CONSTRAINT "PK_GymEquipments" PRIMARY KEY ("Id"),
	CONSTRAINT "FK_GymEquipments_Gyms_GymId" FOREIGN KEY ("GymId") REFERENCES public."Gyms"("Id") ON DELETE CASCADE
);
CREATE INDEX "IX_GymEquipments_GymId" ON public."GymEquipments" USING btree ("GymId");


CREATE TABLE public."Users" (
	"Id" int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	"FirstName" text NOT NULL,
	"LastName" text NOT NULL,
	"LoginId" int4 NULL,
	CONSTRAINT "PK_Users" PRIMARY KEY ("Id"),
	CONSTRAINT "FK_Users_LoginDetails_LoginId" FOREIGN KEY ("LoginId") REFERENCES public."LoginDetails"("Id")
);
CREATE INDEX "IX_Users_LoginId" ON public."Users" USING btree ("LoginId");


CREATE TABLE public."Cycles" (
	"Id" int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	"Name" text NOT NULL,
	"StartDate" timestamptz NULL,
	"LengthInWeeks" int4 NOT NULL,
	"EndDate" timestamptz NULL,
	"UserId" int4 NOT NULL,
	CONSTRAINT "PK_Cycles" PRIMARY KEY ("Id"),
	CONSTRAINT "FK_Cycles_Users_UserId" FOREIGN KEY ("UserId") REFERENCES public."Users"("Id") ON DELETE CASCADE
);
CREATE INDEX "IX_Cycles_UserId" ON public."Cycles" USING btree ("UserId");


CREATE TABLE public."GymEquipmentExercises" (
	"Id" int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	"GymEquipmentId" int4 NOT NULL,
	"ExerciseId" int4 NOT NULL,
	CONSTRAINT "PK_GymEquipmentExercises" PRIMARY KEY ("Id"),
	CONSTRAINT "FK_GymEquipmentExercises_Exercises_ExerciseId" FOREIGN KEY ("ExerciseId") REFERENCES public."Exercises"("Id") ON DELETE CASCADE,
	CONSTRAINT "FK_GymEquipmentExercises_GymEquipments_GymEquipmentId" FOREIGN KEY ("GymEquipmentId") REFERENCES public."GymEquipments"("Id") ON DELETE CASCADE
);
CREATE INDEX "IX_GymEquipmentExercises_ExerciseId" ON public."GymEquipmentExercises" USING btree ("ExerciseId");
CREATE INDEX "IX_GymEquipmentExercises_GymEquipmentId" ON public."GymEquipmentExercises" USING btree ("GymEquipmentId");


CREATE TABLE public."Workouts" (
	"Id" int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	"Date" timestamptz NOT NULL,
	"UserId" int4 NOT NULL,
	"CycleId" int4 NULL,
	CONSTRAINT "PK_Workouts" PRIMARY KEY ("Id"),
	CONSTRAINT "FK_Workouts_Cycles_CycleId" FOREIGN KEY ("CycleId") REFERENCES public."Cycles"("Id") ON DELETE SET NULL,
	CONSTRAINT "FK_Workouts_Users_UserId" FOREIGN KEY ("UserId") REFERENCES public."Users"("Id") ON DELETE CASCADE
);
CREATE INDEX "IX_Workouts_CycleId" ON public."Workouts" USING btree ("CycleId");
CREATE INDEX "IX_Workouts_UserId" ON public."Workouts" USING btree ("UserId");


CREATE TABLE public."WorkoutExercises" (
	"Id" int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	"Notes" text NULL,
	"WorkoutId" int4 NOT NULL,
	"ExerciseId" int4 NOT NULL,
	"GymEquipmentId" int4 NULL,
	CONSTRAINT "PK_WorkoutExercises" PRIMARY KEY ("Id"),
	CONSTRAINT "FK_WorkoutExercises_Exercises_ExerciseId" FOREIGN KEY ("ExerciseId") REFERENCES public."Exercises"("Id") ON DELETE CASCADE,
	CONSTRAINT "FK_WorkoutExercises_GymEquipments_GymEquipmentId" FOREIGN KEY ("GymEquipmentId") REFERENCES public."GymEquipments"("Id") ON DELETE SET NULL,
	CONSTRAINT "FK_WorkoutExercises_Workouts_WorkoutId" FOREIGN KEY ("WorkoutId") REFERENCES public."Workouts"("Id") ON DELETE CASCADE
);
CREATE INDEX "IX_WorkoutExercises_ExerciseId" ON public."WorkoutExercises" USING btree ("ExerciseId");
CREATE INDEX "IX_WorkoutExercises_GymEquipmentId" ON public."WorkoutExercises" USING btree ("GymEquipmentId");
CREATE INDEX "IX_WorkoutExercises_WorkoutId" ON public."WorkoutExercises" USING btree ("WorkoutId");


CREATE TABLE public."WorkoutExerciseSets" (
	"Id" int4 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 2147483647 START 1 CACHE 1 NO CYCLE) NOT NULL,
	"SetNumber" int4 NOT NULL,
	"RepCount" int4 NOT NULL,
	"Weight" int4 NOT NULL,
	"WorkoutExerciseId" int4 NOT NULL,
	CONSTRAINT "PK_WorkoutExerciseSets" PRIMARY KEY ("Id"),
	CONSTRAINT "FK_WorkoutExerciseSets_WorkoutExercises_WorkoutExerciseId" FOREIGN KEY ("WorkoutExerciseId") REFERENCES public."WorkoutExercises"("Id") ON DELETE CASCADE
);
CREATE INDEX "IX_WorkoutExerciseSets_WorkoutExerciseId" ON public."WorkoutExerciseSets" USING btree ("WorkoutExerciseId");